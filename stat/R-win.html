<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Windows用Rガイド</title>
<meta name="viewport" content="width=device-width">
<link rel="stylesheet" href="style.css">
<link rel="author" href="https://plus.google.com/112494697412775886755?rel=author">
<link rel="license" href="http://creativecommons.org/licenses/by/4.0/">
</head>
<body>

<nav id="breadcrumbs">
<a href="../">ホーム</a> &gt;
<a href="./">統計・データ解析</a> &gt;
</nav>

<h1>Windows用Rガイド</h1>

<h2>Rのインストール</h2>

<p>三重大学のコンピュータ教室のPCにはすでにRがインストールされていますので，以下を読む必要はありません。</p>

<p>ご自分のWindows機にRをインストールするには，Rの配布元であるCRANサイト（日本のミラーは統数研 <a href="http://cran.ism.ac.jp/">http://cran.ism.ac.jp/</a> だが，ときどき潰れているので，その場合は <a href="https://www.r-project.org">R Project</a> サイトの左の「CRAN」というリンクから適当なミラーを選ぶ）にアクセスし，「Download R for Windows」→「base」とたどって，「Download R *.*.* for Windows」（* はバージョン番号）をクリックし，「保存」します。保存された R-*.*.*-win.exe というファイルを実行します。</p>

<p>インストーラがいろいろ聞いてきます。すべてデフォルトでもいいのですが，時間があれば，次の点を変更してください。</p>

<ul>
  <li>「カスタムインストール」のところで，もし32ビット版が不要なら，「32-bit Files」のチェックを外します。</li>
  <li>「起動時オプション」のところで，「はい（カスタマイズする）」を選び，次の「MDI」「SDI」の選択画面では「SDI」を選びます。RStudioから使う場合はこの設定は意味がありません。</li>
</ul>

<p>Rをアンインストールするには，他のソフトと同様に「コントロールパネル」の「プログラムと機能」で行います。</p>

<p>なお，デフォルトでRがインストールされる場所は C:\Program Files\R です。この中に R-3.6.1 のような番号付きのフォルダができ，さらにその中にある bin\i386 と bin\x64 にそれぞれ32ビット，64ビット用の実行ファイルが入ります（R.exe，Rscript.exe など）。また，C:\Users\ユーザ名\Documents\R\win-library\3.6 といったところに個人用ライブラリが入ります。</p>

<h2>RStudioのインストール</h2>

<p>三重大学のコンピュータ教室のPCにはすでにRStudioがインストールされていますので，以下を読む必要はありません。</p>

<p>Rの実行に必要ではありませんが，かっこいいフロントエンド（IDE）としてRStudioの人気が高まっています。特にデータセットのインポートが楽になります。必ずRを先にインストールしてから，後でRStudioをインストールしてください。</p>

<p><a href="https://www.rstudio.com/">RStudio</a>ホームページの「RStudio」の下の「Download」をクリックし，「RStudio Desktop」の「Open Source License」と書いてあるもののInstallerをダウンロードします。</p>

<!--
<h2>Rの起動（生のRを使う場合）</h2>

<p>デスクトップのR起動用アイコン（R x64 *.*.*またはR i386 *.*.*）をダブルクリックします。両方ある場合は，通常は64ビット版（x64）で大丈夫でしょう。デスクトップに見つからなければ「スタート」メニューなどから起動します。</p>

<p>複数のRがインストールされている場合は，最も新しいもの（*.*.* の番号の大きいもの）を起動してください。</p>

<p>起動したら，「編集」→「GUIプリファレンス...」で画面構成やフォントの設定を確認します。</p>

<ul>
  <li>一番上のMDI（multiple document interface）・SDI（single document interface）は，好みですが，私はSDIを選んでいます。</li>
  <li>Fontとそのsizeを適当に選びます。デフォルトはCourierの10ポイントです。欧文フォントによっては，日本語文字列を含むデータを後述の「データエディタ」で扱うと文字化けします。</li>
</ul>

<p>フォント設定を適用するには「Apply」ボタンを押します。MDI・SDIの選択は「Apply」では適用されませんので，「Save...」ボタンを押してそのままの場所に「保存」し，Rをいったん終了します。</p>

<p>終了時に「作業スペースを保存しますか？」と聞いてきたら，「いいえ」を選びます。</p>

<div class="note">
<p>設定ファイル Rconsole の保存場所は通常「ドキュメント」です。通常は最初に現れた場所に保存すればいいのですが，保存場所を移動してわからなくなった場合は，Rコンソールに <code>getwd()</code> と打ち込めば，標準の保存場所が例えば <code>C:/Users/hoge/Documents</code> のように表示されます。</p>
</div>
-->

<h2>RStudioの起動</h2>

<p>デスクトップにRStudioのアイコンがあればそれをダブルクリックします。なければスタートボタンからRStudioを起動します。</p>

<div class="note">
<p>三重大学総情センターの端末室のPCではデスクトップの「統計解析」フォルダの中にRStudioがあります。</p>
</div>

<p>通常のRと同様に使えます。終了時に「Save workspace image to ~/.RData?」のように聞いてきたら，通常は「Don't Save」を選びます。</p>

<h2>データファイルを読む（RStudioを使う場合）</h2>

<p>データはExcelで入力しておくのが便利です。Rに読み込むには，右上ペインの「Import Dataset」から「From Excel...」を選びます（初回に使う際にライブラリreadxlとRcppがインストールされていなければインストールが行われます）。右上の「Browse...」からExcelファイルを選びます。例えばhoge.xlsxを選べば，次のRコマンドが自動で実行されます：</p>

<pre>
library(readxl)
hoge = read_excel("~/hoge.xlsx")
View(hoge)
</pre>

<p>左上ペインにデータが表示されます。</p>

<!--
<h2>Rコマンダーのインストール（生のRを使う場合）</h2>

<p>RコマンダーはRをマウスだけで使うためのパッケージです。初心者には便利かもしれません。</p>

<p>Rコンソールで「パッケージ」→「パッケージのインストール...」をクリックします。初回はCRANミラーサイトを聞いてきますので，日本のどこか（東京または筑波または…）を選びます。パッケージ一覧が現れますので，「Rcmdr」を選びます。</p>

<p>次に，Rコンソールで「パッケージ」→「パッケージの読み込み...」をクリックし，一覧から「Rcmdr」を選び「OK」します。すると，「Rcmdrが利用する次のパッケージがありません…これらのパッケージをインストールしますか？」と聞いてきますので，「はい（Y）」を押します。何か聞いてきたら「OK」で進みます。</p>
-->

<h2>雑多なこと</h2>

<p>プログラムが止まらなくなった：WindowsではESCキーで止まります。</p>

<p>長い綴りを打つのが面倒：TABキーで補完できます。補完候補が複数ある場合はTABキーを2回押すと候補の一覧が現れます。</p>

<p>打ち間違えた：上向き矢印キーで戻って編集できます。</p>

<hr>

<p><a href="../" rel="author">奥村 晴彦</a></p>

<p>
<!-- hhmts start -->
Last modified: <time>2019-07-22 09:51:30</time>
<!-- hhmts end -->
</p>
</body>
</html>
