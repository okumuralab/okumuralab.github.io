<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<title>実行</title>
<link rel="stylesheet" href="style.css">
<link rel="license" href="http://creativecommons.org/licenses/by/4.0/">
</head>
<body>

<nav id="breadcrumbs">
<a href="/~okumura/">ホーム</a> &gt;
<a href="./">Python</a> &gt;
</nav>

<h1>実行</h1>

<p>Python の実行には，いくつかの方法があります。</p>

<p>以下では Python 3 を起動するコマンドは <code>python3</code> であると仮定します（環境によっては <code>python</code> でよいかもしれません）。</p>

<p>念のため，<code>python</code> あるいは <code>python3</code> で起動する Python のバージョンを確認しておきましょう：</p>

<pre>
python --version
python3 --version
</pre>

<h3>python コマンド（REPL）</h3>

<p>ターミナル（Windows であれば PowerShell など）に</p>

<pre>
python3
</pre>

<p>とだけ打ち込むと，<code>&gt;&gt;&gt;</code> というプロンプトが現れますので，その右側に Python の命令を打ち込みます。例えば</p>

<pre>
print("こんにちは")
</pre>

<p>と打ち込めば，ターミナルに「こんにちは」と現れます。</p>

<p>もうちょっと長いものを打ち込んでみましょう：</p>

<pre>
for i in range(3):
    print("大事なので3回言います")
</pre>

<p>Python はインデント（字下げ）でブロック構造を表すので，インデントを省略しないでください。</p>

<p>ターミナルに戻るには，<code>quit()</code> または <code>exit()</code> と打ち込みます。</p>

<h3>IPython</h3>

<p>IPython なら，もう少し対話的に（interactive に）Python を使えます。ターミナル（Windows であれば PowerShell など）に</p>

<pre>
ipython
</pre>

<p>と打ち込みます（もし古い Python 2 が出てくるようなら，<code>ipython3</code> と打ち込みます）。</p>

<p>実際には，いくつかオプションを付けて起動することが多いと思います。例えば文字に色が付いてかえって見にくいなら <code>--colors='NoColor'</code>，matplotlib を使うなら <code>--matplotlib</code> などです。</p>

<div class="note">
<p>Emacs の <code>M-x shell</code> 内で使うなら，おそらく <code>--simple-prompt</code> オプションが必要です。</p>
</div>

<p>ヘルプを見るには，例えば <code>?print</code> のように打ち込みます（このヘルプの終了は <code>q</code>）。</p>

<p><code>quit</code> と打ち込めば終了します。</p>

<h3>スクリプト</h3>

<p>Python プログラム，例えば</p>

<pre>
for i in range(3):
    print("大事なので3回言います")
</pre>

<p>は，テキストファイルとして保存してから実行することができます。テキストファイルとして保存した実行可能なプログラムを「スクリプト」と呼びます。テキストファイルですから，Windows の「メモ帳」や Mac の「テキストエディット」などの標準テキストエディタで作成できますが，本格的にプログラミングをするなら，<a href="https://atom.io">Atom</a> や <a href="https://code.visualstudio.com">Visual Studio Code</a> や Emacs や Vim のようなプログラミング専用テキストエディタが便利です。</p>

<p>Python スクリプトのファイル名は <code>test.py</code> のように拡張子を <code>py</code> にします。保存の際の文字コードは UTF-8 にします。実行するには，ターミナル（Windows ならコマンドプロンプトか PowerShell）で（スクリプトを保存したディレクトリに移動してから）</p>

<pre>
python3 test.py
</pre>

<p>と打ち込みます。文字化けする場合は，文字コードが UTF-8 になっているか確認してください。</p>

<p>Linux や Mac などの UNIX 環境で実行可能なスクリプトにするには，先頭に <code>#! /usr/bin/env python3</code> を付けます（複数の <code>python3</code> があって具体的に指定したい場合は <code>#! /usr/local/bin/python3</code> などのようにします）：</p>

<pre>
#! /usr/bin/env python3

for i in range(3):
    print("大事なので3回言います")
</pre>

<p>この場合も文字コードは UTF-8 ですが，特に <code>#!</code> で始まる場合は BOM を付けないように注意する必要があります。実行可能にするには，ターミナルで</p>

<pre>
chmod 755 test.py
</pre>

<p>のように打ち込みます。これで，ターミナルに</p>

<pre>
./test.py
</pre>

<p>と打ち込めば実行されます。便利なスクリプトなら，拡張子を付けないで <code>/usr/local/bin</code> のようなパスの通った場所に置いておくといいかもしれません。</p>

<p>もしどうしても別の文字コード，例えば Shift JIS にしたいなら，</p>

<pre>
#! /usr/bin/env python3
# -*- coding: shift_jis -*-

for i in range(3):
    print("大事なので3回言います")
</pre>

<p>のようにします。</p>

<p>スクリプトとして実行する場合は，コマンドライン引数が <code>sys.argv</code> というリストに入ります。次のような簡単なスクリプトで実験できます：</p>

<pre>
#! /usr/bin/env python3

import sys

print(sys.argv)
</pre>

<p>もし Python 2 で書かれたスクリプト <code>filename.py</code> があれば，コマンド <code>2to3 -w filename.py</code> で Python 3 の文法に書き直してくれます。オリジナルは <code>filename.py.bak</code> にリネームされます。詳しくはマニュアルの <a href="https://docs.python.org/3/library/2to3.html">2to3</a> 参照。</p>

<h3>One-Liner</h3>

<p>ターミナルで1行だけの Python スクリプトを実行できます：</p>

<pre>
$ python3 -c 'x=2;y=32;print(x**y)'
4294967296
</pre>

<h3>Jupyter Notebook</h3>

<p><a href="https://jupyter.org">Jupyter Notebook</a>（ジュピター・ノートブック）はブラウザ上で使える Mathematica Notebook のような環境です。もともと Julia，Python，R などをサポートするということで Jupyter という名前になったようですが，今は40以上の言語に対応しています。</p>

<p>ターミナルに</p>

<pre>
jupyter notebook
</pre>

<p>と打ち込むと，Web ブラウザが立ち上がって，カレントディレクトリのファイル名一覧が表示されます（Mac や Linux なら <code>jupyter notebook &amp;</code> と打ち込めばバックグラウンド動作になります）。もし拡張子が ipynb のファイルがあれば，それを開けば前回の続きの計算ができます。新しいノートブックを開くには，この画面で [New ▼] ボタンを押し Python 3 を選びます。一番上の Untitled をクリックすると，ノートブックの名前が変えられます。ちなみに，拡張子 ipynb は，Jupyter Notebook が IPython Notebook と呼ばれていたころの名残りです。</p>

<p>In [ ]: の右の箱に Python のプログラムを打ち込みます。何行かまとめて入れることもできます。最後の行の値が（<code>print()</code> を使わないでも）表示されます。Shift + Enter で，実行し次の箱に移動します（または Ctrl + Enter で，実行し次の箱に移動しません）。</p>

<p>[Code ↕︎] ボタンを [Markdown ↕︎] に切り替えれば，Markdown 形式で説明が書けます。<code>$E = mc^2$</code> のように <code>$</code> で挟んで数式を書くこともできます。</p>

<p>終了は File → Close and Halt です。右上の [Quit] で Web サーバが終了します。</p>

<p>拡張子 ipynb のファイルを GitHub にプッシュすれば，ドキュメントとコードと実行結果が公開できます。この方法によるドキュメント作成は GitHub 上で数式を表示するための便利な方法でもあります（Markdown 形式では数式はうまく表示できません）。</p>

<h3>Emacs 内で IPython を動かす</h3>

<p>いろいろな方法があるようですが，デフォルトの python.el で提供される Python モードでの方法を説明します。</p>

<p><code>~/.emacs.d/init.el</code> には次のように書いておきます：</p>

<pre>
(setq python-shell-interpreter "ipython"
      python-shell-interpreter-args "--simple-prompt --matplotlib -i")
</pre>

<p>拡張子 <code>py</code> のファイルを開くと，自動的に Python モードになります。まずは C-c C-p (run-python) で IPython プロセスを起動します（拡張子 <code>py</code> のファイルを開かなくても直接 M-x run-python でも起動できます）。バッファ全体を実行するには C-c C-c (python-shell-send-buffer)，選択したリージョンを実行するには C-c C-r (python-shell-send-region) とします。詳しくは，M-x help の次に m と打つと，モードのヘルプが現れます。</p>

<hr>

<p><a href="../" rel="author">奥村 晴彦</a></p>

<p>
<!-- hhmts start -->
Last modified: <time>2019-06-27 08:22:44</time>
<!-- hhmts end -->
</p>
</body>
</html>
