<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<title>素因数分解</title>
<link rel="stylesheet" href="style.css">
<link rel="license" href="http://creativecommons.org/licenses/by/4.0/">
</head>
<body>

<nav id="breadcrumbs">
<a href="/~okumura/">ホーム</a> &gt;
<a href="./">Python</a> &gt;
</nav>

<h1>素因数分解</h1>

<p>今日 20190823 は素数：</p>

<pre>
import math, time

n = int(time.strftime('%Y%m%d', time.localtime()))
print(n, "=", end=" ")
for i in range(2, int(math.sqrt(n)+0.5)+1):
    if n % i == 0:
        print(i, end='*')
        n //= i
print(n)
</pre>

<p><code>math.sqrt()</code> は平方数については正確な平方根を与えるはずだが，浮動小数点数の精度を超える整数の場合は心配である。整数の平方根を整数の範囲で求める次の <code>isqrt()</code> を使うとよい（<code>isqrt()</code> は下に紹介する primefac パッケージに含まれている）：</p>

<pre>
def isqrt(n):
    if n == 0:
        return 0
    x, y = n, (n + 1) // 2
    while y < x:
        x, y = y, (y + n // y) // 2
    return x
</pre>

<p>これを使った関数：</p>

<pre>
def isprime(n):
    if n < 2:
        return False
    for i in range(2, isqrt(n)+1):
        if n % i == 0:
            return False
    return True
</pre>

<p>いろいろ改良が可能である。2を除けば偶数で割ってみる必要はないので，計算量は半分にできる。</p>

<p>もっと大きい数の素因数分解をするライブラリ <a href="https://pypi.org/project/primefac/">primefac</a>（旧 pyfac）は今のところ Python 2 にしか対応していない。Python 3 に対応させた <a href="https://github.com/elliptic-shiho/primefac-fork">primefac-fork</a> がある。インストールするには：</p>

<pre>
pip install git+git://github.com/elliptic-shiho/primefac-fork@master
</pre>

<p><a href="https://pypi.org/project/factordb-pycli/">factordb-pycli</a> と <a href="https://pypi.org/project/gmpy/">gmpy</a> もインストールされる。</p>

<p>使い方：</p>

<pre>
import primefac

primefac.factorint(5040)
# ==&gt; {2: 4, 3: 2, 5: 1, 7: 1}

primefac.factorint(20190823)
# ==&gt; {20190823: 1}
</pre>

<hr>

<p><a href="../" rel="author">奥村 晴彦</a></p>

<p>
<!-- hhmts start -->
Last modified: <time>2019-08-23 15:32:26</time>
<!-- hhmts end -->
</p>
</body>
</html>
