<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<title>データの読み込み</title>
<link rel="stylesheet" href="style.css">
<link rel="license" href="http://creativecommons.org/licenses/by/4.0/">
</head>
<body>

<nav id="breadcrumbs">
<a href="/~okumura/">ホーム</a> &gt;
<a href="./">Python 3</a> &gt;
</nav>

<h1>データの読み込み</h1>

<p>Python でデータを読み込むときは <a href="https://pandas.pydata.org/">pandas</a> というライブラリを使います。</p>

<pre>
import pandas as pd
data = pd.read_csv("filename.csv")
data.head()   # 頭の5行だけ表示
</pre>

<p>ファイル名は URL でもかまいません。</p>

<p><code>read_csv()</code> でよく使うオプションは，Shift JIS の CSV を読むための <code>encoding="cp932"</code>，特定の文字（例えば <code>#</code>）以下をコメントと解釈するための <code>comment="#"</code> です。</p>

<p>Excel ファイル（xls，xlsx）を読むには xlrd というライブラリが必要です。別途 <code>conda install xlrd</code> または <code>pip(3) install xlrd</code> などとしてインストールしておきます。<code>read_excel()</code> を使うと自動的に import されます。</p>

<pre>
data = pd.read_excel("filename.xlsx")
</pre>

<p><code>read_csv()</code> や <code>read_excel()</code> などの詳細は <a href="http://pandas.pydata.org/pandas-docs/stable/user_guide/io.html">pandas の IO Tools</a> のページ，あるいは IPython で <code>?pd.read_csv</code> と打ち込むと出てくるヘルプをご覧ください。</p>

<p>読み込んだデータは <code>DataFrame</code> オブジェクトです：</p>

<pre>
In [ ]: type(data)
Out[ ]: pandas.core.frame.DataFrame
</pre>

<p>pandas の DataFrame は R のデータフレームとほぼ同じです。簡単な解説が <a href="http://pandas.pydata.org/pandas-docs/stable/getting_started/10min.html">10 Minutes to pandas</a> にあります。</p>

<p>各列の名前を表示するには <code>data.columns</code>，各列の名前とデータ型を表示するには <code>data.dtypes</code> と打ち込みます。これ以外に行の名前（デフォルトでは 0 から始まる行番号）を格納する <code>data.index</code> があります。</p>

<p><code>data.describe()</code> と打ち込めば，数値を含む行について記述統計量を表示します。</p>

<p>データの（0から数えて）例えば2行目から4行目を選択するには <code>data[2:5]</code> のようにします。データの一部の列を選択するには <code>data.列名</code> あるいは <code>data['列名']</code> あるいは <code>data[['列名1','列名2']]</code> のようにします。行列のように行名・列名で選ぶには <code>data.loc['行名','列名']</code>，行番号・列番号で選ぶには <code>data.iloc[行番号,列番号]</code> とします。複数与えるには <code>[2,3,4]</code> のようにリストにするか，<code>2:5</code> のように範囲で表します（Pythonでは番号は0から数え，<code>2:5</code> のような範囲は最後の5を含まないことに注意）。</p>

<hr>

<p><a href="../" rel="author">奥村 晴彦</a></p>

<p>
<!-- hhmts start -->
Last modified: <time>2019-05-04 09:16:36</time>
<!-- hhmts end -->
</p>
</body>
</html>
