<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<title>素数の判定</title>
<link rel="stylesheet" href="style.css">
<link rel="license" href="http://creativecommons.org/licenses/by/4.0/">
</head>
<body>

<nav id="breadcrumbs">
<a href="/~okumura/">ホーム</a> &gt;
<a href="./">Python</a> &gt;
</nav>

<h1>素数の判定</h1>

<p>与えられた数 <code>n</code> が素数なら <code>True</code>，そうでなければ <code>False</code> を返す関数を作ってみましょう。</p>

<p>基本は順に割っていけばよいはずです。</p>

<pre>
<code>def isprime(n):
    if n < 2:
        return False
    for i in range(2, n):
        if n % i == 0:
            return False
    return True
</code></pre>

<p>動作確認してみましょう。</p>

<pre>
<code>for i in range(2,100):
    if isprime(i):
        print(i, 'は素数')
</code></pre>

<p>上は 2 以上 <code>n</code> 未満の整数すべてで割ってみました。もっと節約できるでしょうか。</p>

<pre>
<code>import math

def isprime(n):
    if n < 2:
        return False
    for i in range(2, int(math.sqrt(n)) + 1):
        if n % i == 0: return False
    return True
</code></pre>

<p>いろいろ改良ができそうです。例えば 2 を除けば偶数で割ってみる必要はないので，計算量は半分にできます。</p>

<pre>
<code>import math

def isprime(n):
    if n < 2:
        return False
    if n == 2:
        return True
    if n % 2 == 0:
        return False
    for i in range(3, int(math.sqrt(n)) + 1, 2):
        if n % i == 0: return False
    return True
</code></pre>

<p>今日（例えば 20190823）は素数か？</p>

<pre>
<code>import datetime

n = int(f'{datetime.datetime.now():%Y%m%d}')
isprime(n)
</code></pre>

<p><code>math.sqrt()</code> は平方数については正確な平方根を与えるはずですが，浮動小数点数の精度を超える整数の場合は心配です。整数の平方根を整数の範囲で求める次の <code>isqrt()</code> を使えば万全です：</p>

<pre>
<code>def isqrt(n):
    if n == 0:
        return 0
    x, y = n, (n + 1) // 2
    while y < x:
        x, y = y, (y + n // y) // 2
    return x
</code></pre>

<p>これを使った関数：</p>

<pre>
<code>def isprime(n):
    if n < 2:
        return False
    for i in range(2, isqrt(n)+1):
        if n % i == 0:
            return False
    return True
</code></pre>

<p>もっと大きい数の素因数分解をするには，<a href="https://docs.sympy.org/latest/modules/ntheory.html">SymPy の数論ライブラリ</a>が便利です。</p>

<pre>
<code>import sympy

sympy.factorint(5040)
# ==&gt; {2: 4, 3: 2, 5: 1, 7: 1}

sympy.factorint(20190823)
# ==&gt; {20190823: 1}

sympy.isprime(20190823)
# ==&gt; True
</code></pre>

<hr>

<p><a href="../" rel="author">奥村 晴彦</a></p>

<p>
<!-- hhmts start -->
Last modified: <time>2020-12-17 14:42:46</time>
<!-- hhmts end -->
</p>
</body>
</html>
