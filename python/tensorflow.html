<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<title>TensorFlowによる機械学習</title>
<link rel="stylesheet" href="style.css">
<link rel="license" href="http://creativecommons.org/licenses/by/4.0/">
</head>
<body>

<nav id="breadcrumbs">
<a href="/~okumura/">ホーム</a> &gt;
<a href="./">Python</a> &gt;
</nav>

<h1>TensorFlowによる機械学習</h1>

<p><a href="https://www.tensorflow.org/">TensorFlow</a>（テンサーフロー，テンソルフロー）は Google の機械学習ライブラリである。</p>

<p>TensorFlow 1 系（最新は 1.14）をインストールするには</p>

<pre>
pip3 install tensorflow  # または conda install tensorflow
</pre>

<p>とするが，ここでは Tensorflow 2.0 beta を使ってみる：</p>

<pre>
pip3 install tensorflow==2.0.0-beta1
</pre>

<p>ごくごく簡単な例として，<a href="https://www.tensorflow.org/tutorials/">TensorFlow のチュートリアル</a>の最初の例をやってみる。データには有名な <a href="http://yann.lecun.com/exdb/mnist/">MNIST</a> を使う。これは28×28ピクセルの手書き画像で，ピクセル値は0から255までの整数である。MNIST については<a href="../mnist.html">こちら</a>も参照されたい。</p>

<pre>
import tensorflow as tf
mnist = tf.keras.datasets.mnist

(x_train, y_train), (x_test, y_test) = mnist.load_data()
</pre>

<p>ピクセルは0〜255の整数値だが，0〜1の実数に変換する：</p>

<pre>
x_train = x_train / 255.0
x_test  = x_test  / 255.0
</pre>

<p>ごくごく簡単なモデルを定義する：</p>

<pre>
model = tf.keras.models.Sequential([
  tf.keras.layers.Flatten(input_shape=(28, 28)),
  tf.keras.layers.Dense(128, activation='relu'),
  tf.keras.layers.Dropout(0.2),
  tf.keras.layers.Dense(10, activation='softmax')
])

model.compile(optimizer='adam',
              loss='sparse_categorical_crossentropy',
              metrics=['accuracy'])
</pre>

<p>いよいよフィット（重い）：</p>

<pre>
model.fit(x_train, y_train, epochs=5)
</pre>

<p>最後に評価：</p>

<pre>
model.evaluate(x_test, y_test)
</pre>

<p>正解率 0.978 程度である。</p>

<p>上記ページのサンプルには載っていないが，予測は次のようにして求められる：</p>

<pre>
y_pred = model.predict_classes(x_test)
</pre>

<p>混同行列を求める：</p>

<pre>
tf.math.confusion_matrix(y_test, y_pred)
</pre>

<hr>

<p><a href="../" rel="author">奥村 晴彦</a></p>

<p>
<!-- hhmts start -->
Last modified: <time>2019-06-26 13:57:43</time>
<!-- hhmts end -->
</p>
</body>
</html>
